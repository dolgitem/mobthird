import{H as X,b2 as Y,r as q,w as Z,c as v,a1 as ee,a5 as U,h as te,g as oe,ac as N,a2 as A,ai as E,k as u,l as P,m as a,j as e,p as m,aa as Q,B as I,C as F,E as x,x as i,y as l,A as M,ad as W,G as T,v as c,Q as K,a8 as C,a7 as H,n as D,t as S,u as p,F as ae,q as le}from"./index.3c8f5d62.js";import{Q as L}from"./QItemLabel.05f8875d.js";import{_ as se}from"./PassItem.baa89710.js";import{u as ne,a as ue,b as re,k as de}from"./use-slider.dc1bdbd8.js";import{u as t}from"./shop.23f3440a.js";import"./TouchPan.62eac7f9.js";const ie=()=>({});var ce=X({name:"QSlider",props:{...ne,modelValue:{required:!0,default:null,validator:n=>typeof n=="number"||n===null},labelValue:[String,Number]},emits:ue,setup(n,{emit:d}){const{proxy:{$q:R}}=oe(),{state:s,methods:o}=re({updateValue:B,updatePosition:G,getDragging:j,formAttrs:Y(n)}),V=q(null),b=q(0),r=q(0);function g(){r.value=n.modelValue===null?s.innerMin.value:U(n.modelValue,s.innerMin.value,s.innerMax.value)}Z(()=>`${n.modelValue}|${s.innerMin.value}|${s.innerMax.value}`,g),g();const y=v(()=>o.convertModelToRatio(r.value)),_=v(()=>s.active.value===!0?b.value:y.value),h=v(()=>{const f={[s.positionProp.value]:`${100*s.innerMinRatio.value}%`,[s.sizeProp.value]:`${100*(_.value-s.innerMinRatio.value)}%`};return n.selectionImg!==void 0&&(f.backgroundImage=`url(${n.selectionImg}) !important`),f}),w=o.getThumbRenderFn({focusValue:!0,getNodeData:ie,ratio:_,label:v(()=>n.labelValue!==void 0?n.labelValue:r.value),thumbColor:v(()=>n.thumbColor||n.color),labelColor:v(()=>n.labelColor),labelTextColor:v(()=>n.labelTextColor)}),k=v(()=>s.editable.value!==!0?{}:R.platform.is.mobile===!0?{onClick:o.onMobileClick}:{onMousedown:o.onActivate,onFocus:J,onBlur:o.onBlur,onKeydown:O,onKeyup:o.onKeyup});function B(f){r.value!==n.modelValue&&d("update:modelValue",r.value),f===!0&&d("change",r.value)}function j(){return V.value.getBoundingClientRect()}function G(f,$=s.dragging.value){const z=o.getDraggingRatio(f,$);r.value=o.convertRatioToModel(z),b.value=n.snap!==!0||n.step===0?z:o.convertModelToRatio(r.value)}function J(){s.focus.value=!0}function O(f){if(!de.includes(f.keyCode))return;ee(f);const $=([34,33].includes(f.keyCode)?10:1)*s.keyStep.value,z=([34,37,40].includes(f.keyCode)?-1:1)*(s.isReversed.value===!0?-1:1)*(n.vertical===!0?-1:1)*$;r.value=U(s.roundValueFn.value(r.value+z),s.innerMin.value,s.innerMax.value),B()}return()=>{const f=o.getContent(h,s.tabindex,k,$=>{$.push(w())});return te("div",{ref:V,class:s.classes.value+(n.modelValue===null?" q-slider--no-value":""),...s.attributes.value,"aria-valuenow":n.modelValue},f)}}});const me=x("div",{class:"text-h6 text-header text-center q-pt-md q-pb-sm"},"\u0421\u043F\u0438\u0441\u0430\u0442\u044C \u0431\u043E\u043D\u0443\u0441\u044B",-1),fe={key:0,class:"disabled fixed fullscreen text-center",style:{background:"rgba(0,0,0,.4)"}},ve={class:"q-mb-sm"},pe={key:0},ge={__name:"CheckoutBonusModal",setup(n){const d=N().settings,s=A().currentRoute.value,o=q(0),V=()=>{o.value=t().spendBonuses},b=v(()=>t().checkout.notEnoughBonuses||t().checkout.bonusLimitError),r=v(()=>t().checkout.notEnoughBonuses?"\u041D\u0435\u0434\u043E\u0441\u0442\u0430\u0442\u043E\u0447\u043D\u043E \u0431\u043E\u043D\u0443\u0441\u043E\u0432 \u043D\u0430 \u0431\u0430\u043B\u0430\u043D\u0441\u0435":t().checkout.bonusLimitError?t().checkout.bonusLimitError:""),g=v(()=>t().loadingCheckout||E().loadingClientInfo),y=()=>{t().spendBonuses=o.value,t().getPassPrice(s.params.passId).then(()=>{typeof t().checkout.notEnoughBonuses=="undefined"&&typeof t().checkout.bonusLimitError=="undefined"?C().closeModal("checkoutBonusModal"):(t().spendBonuses=0,E().getClientInfo().then(()=>{o.value>t().maxBonuses&&(o.value=t().maxBonuses)}))})},_=()=>{isNaN(parseInt(o.value))&&(o.value=0)},h=w=>{!isNaN(parseInt(o.value))&&o.value>t().maxBonuses&&(o.value=t().maxBonuses)};return(w,k)=>(u(),P(H,{modelValue:l(C)().modals.checkoutBonusModal,"onUpdate:modelValue":k[2]||(k[2]=B=>l(C)().modals.checkoutBonusModal=B),position:"bottom",maximized:"",onBeforeShow:V},{default:a(()=>[e(K,{padding:""},{default:a(()=>[me,g.value?(u(),m("div",fe,[e(Q,{class:"absolute-center",color:"primary",size:"50px"})])):I("",!0),e(F,{class:"q-pt-sm"},{default:a(()=>[x("div",ve,[x("span",null,"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u0434\u043B\u044F \u0441\u043F\u0438\u0441\u0430\u043D\u0438\u044F "+i(l(t)().maxBonuses)+" \u0438\u0437 "+i(l(E)().client.bonusBalance),1),e(M,{class:"text-icon-default q-ml-sm",style:{"font-size":"16px"},name:"fa-solid fa-coins"})]),e(W,{type:"number","bg-color":"grey-3",outlined:"",modelValue:o.value,"onUpdate:modelValue":k[0]||(k[0]=B=>o.value=B),modelModifiers:{number:!0},max:l(t)().maxBonuses,label:"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0431\u043E\u043D\u0443\u0441\u043E\u0432",onBlur:_,onKeyup:h,"error-message":r.value,error:b.value},{append:a(()=>[e(T,{onClick:y,dense:"",unelevated:"",color:"grey-3","text-color":"grey-9"},{default:a(()=>[c(" \u0421\u043F\u0438\u0441\u0430\u0442\u044C ")]),_:1})]),_:1},8,["modelValue","max","error-message","error"]),e(ce,{class:"q-pt-md",modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=B=>o.value=B),min:0,max:l(t)().maxBonuses},null,8,["modelValue","max"]),l(d).enableClientBonusSystem&&l(d).showClientBonusWapi&&!l(d).allowApplyBonusWithPromocode?(u(),m("div",pe," \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043B\u0438\u0431\u043E \u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0431\u043E\u043D\u0443\u0441\u043E\u0432, \u043B\u0438\u0431\u043E \u043F\u0440\u0438\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434\u0430. ")):I("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},_e=x("div",{class:"text-h6 text-header text-center q-pt-md q-pb-sm"}," \u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 ",-1),he={key:0,class:"disabled fixed fullscreen text-center",style:{background:"rgba(0,0,0,.4)"}},xe={key:0,class:"q-mt-sm"},be={__name:"CheckoutPromocodeModal",setup(n){const d=N().settings,s=A().currentRoute.value,o=q(""),V=()=>{t().promocode=o.value,t().getPassPrice(s.params.passId).then(()=>{typeof t().checkout.invalidPromocode=="undefined"?C().closeModal("checkoutPromocodeModal"):t().promocode=""})},b=()=>{o.value=t().promocode};return(r,g)=>(u(),P(H,{modelValue:l(C)().modals.checkoutPromocodeModal,"onUpdate:modelValue":g[1]||(g[1]=y=>l(C)().modals.checkoutPromocodeModal=y),position:"bottom",maximized:"",onBeforeShow:b},{default:a(()=>[e(K,{padding:""},{default:a(()=>[_e,l(t)().loadingCheckout?(u(),m("div",he,[e(Q,{class:"absolute-center",color:"primary",size:"50px"})])):I("",!0),e(F,{class:"q-pt-sm"},{default:a(()=>[e(W,{type:"text","bg-color":"grey-3",outlined:"",modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=y=>o.value=y),label:"\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434","error-message":"\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0438\u043B\u0438 \u0443\u0436\u0435 \u043D\u0435\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u0435\u043D.",error:l(t)().checkout.invalidPromocode},{append:a(()=>[e(T,{onClick:V,dense:"",unelevated:"",color:"grey-3","text-color":"grey-9"},{default:a(()=>[c(" \u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C ")]),_:1})]),_:1},8,["modelValue","error"]),l(d).enableClientBonusSystem&&l(d).showClientBonusWapi&&!l(d).allowApplyBonusWithPromocode?(u(),m("div",xe," \u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u043B\u0438\u0431\u043E \u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0431\u043E\u043D\u0443\u0441\u043E\u0432, \u043B\u0438\u0431\u043E \u043F\u0440\u0438\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434\u0430. ")):I("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ye={key:1},ke={key:1},Be=x("div",{class:"text-subtitle1"},"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434",-1),Ce={key:0},Ve={key:1},Me=x("div",{class:"text-subtitle1"},"\u0421\u043F\u0438\u0441\u0430\u0442\u044C \u0431\u043E\u043D\u0443\u0441\u044B",-1),Pe={key:0},Se={key:1},qe={class:"bg-card-light border-sm"},we=x("div",null,"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C",-1),$e={key:0},Ie={key:1},Te={__name:"CheckoutPage",setup(n){const d=q(!0),s=A().currentRoute.value,o=N().settings;(()=>{t().getPass(s.params.passId).then(()=>{t().getPassPrice(s.params.passId)})})();const b=v(()=>t().pass),r=v(()=>t().checkout),g=()=>{};return(y,_)=>(u(),m("div",null,[l(t)().loading?(u(),P(Q,{key:0,class:"absolute-center",color:"primary",size:"50px"})):(u(),m("div",ye,[e(se,{pass:b.value,hidePurchaseButton:!0},null,8,["pass"]),l(t)().loadingCheckout?(u(),P(Q,{key:0,class:"absolute-center",color:"primary",size:"50px"})):(u(),m("div",ke,[e(D,{padding:""},{default:a(()=>[e(L,{class:"text-header text-h6 q-mb-sm"},{default:a(()=>[c(" \u041F\u0440\u0438\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u0441\u043A\u0438\u0434\u043E\u043A ")]),_:1}),e(S,{class:"bg-card-light list-item-border q-py-sm q-my-sm",clickable:"",onClick:_[0]||(_[0]=h=>{l(C)().openModal("checkoutPromocodeModal")}),disable:l(t)().spendBonuses>0&&!l(o).allowApplyBonusWithPromocode},{default:a(()=>[e(p,{avatar:"",class:"no-padding"},{default:a(()=>[e(M,{class:"text-icon-default",style:{"font-size":"16px"},name:"fa-solid fa-plus"})]),_:1}),e(p,null,{default:a(()=>[Be,l(t)().promocode.length>0?(u(),m("div",Ce,"\u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 \u043F\u0440\u0438\u043C\u0435\u043D\u0435\u043D")):(u(),m("div",Ve,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434"))]),_:1})]),_:1},8,["disable"]),e(S,{class:"bg-card-light list-item-border q-py-sm q-my-sm",clickable:"",onClick:_[1]||(_[1]=h=>{l(C)().openModal("checkoutBonusModal")}),disable:l(t)().promocode.length>0&&!l(o).allowApplyBonusWithPromocode},{default:a(()=>[e(p,{avatar:"",class:"no-padding"},{default:a(()=>[e(M,{class:"text-icon-default",style:{"font-size":"16px"},name:"fa-solid fa-plus"})]),_:1}),e(p,null,{default:a(()=>[Me,l(t)().spendBonuses>0?(u(),m("div",Pe,[c(i(l(t)().spendBonuses)+" \u0438\u0437 "+i(l(t)().maxBonuses)+" ",1),e(M,{class:"text-icon-default q-mx-sm",style:{"font-size":"16px"},name:"fa-solid fa-coins"}),c(" \u0431\u0443\u0434\u0443\u0442 \u0441\u043F\u0438\u0441\u0430\u043D\u044B \u043F\u0440\u0438 \u043E\u043F\u043B\u0430\u0442\u0435 ")])):(u(),m("div",Se,[c("\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u043E \u0434\u043B\u044F \u0441\u043F\u0438\u0441\u0430\u043D\u0438\u044F "+i(l(t)().maxBonuses)+" ",1),e(M,{class:"text-icon-default q-ml-sm",style:{"font-size":"16px"},name:"fa-solid fa-coins"})]))]),_:1})]),_:1},8,["disable"])]),_:1}),e(D,{padding:"",dense:""},{default:a(()=>[e(L,{class:"text-header text-h6 q-mb-sm"},{default:a(()=>[c(" \u041A \u043E\u043F\u043B\u0430\u0442\u0435 ")]),_:1}),x("div",qe,[e(S,{class:""},{default:a(()=>[e(p,null,{default:a(()=>[we]),_:1}),e(p,{class:"text-right"},{default:a(()=>[x("div",null,i(b.value.fullPrice)+" "+i(l(o).currencyUnit),1)]),_:1})]),_:1}),e(S,{clickable:"",onClick:_[2]||(_[2]=h=>d.value=!d.value)},{default:a(()=>[e(p,null,{default:a(()=>[x("div",null,[c("\u0421\u043A\u0438\u0434\u043A\u0430 "),d.value?(u(),P(M,{key:0,class:"text-icon-default",style:{"font-size":"16px"},name:"fa-solid fa-angle-down"})):(u(),P(M,{key:1,class:"text-icon-default",style:{"font-size":"16px"},name:"fa-solid fa-angle-up"}))])]),_:1}),e(p,{class:"text-right"},{default:a(()=>[c(i(r.value.totalDiscount)+" "+i(l(o).currencyUnit),1)]),_:1})]),_:1}),d.value?I("",!0):(u(!0),m(ae,{key:0},le(r.value.discounts,(h,w)=>(u(),P(S,{class:"q-pl-lg",key:w},{default:a(()=>[e(p,null,{default:a(()=>[c(i(h.text),1)]),_:2},1024),e(p,{class:"text-right"},{default:a(()=>[x("div",null,[c(i(h.amount||h.percent)+" ",1),h.percent?(u(),m("span",$e,"%")):(u(),m("span",Ie,i(l(o).currencyUnit),1))])]),_:2},1024)]),_:2},1024))),128)),e(S,{class:"text-bold"},{default:a(()=>[e(p,null,{default:a(()=>[c(" \u0418\u0442\u043E\u0433\u043E ")]),_:1}),e(p,{class:"text-right"},{default:a(()=>[c(i(r.value.totalPrice)+" "+i(l(o).currencyUnit),1)]),_:1})]),_:1})])]),_:1}),e(T,{class:"border-sm bg-card-dark q-px-xl full-width",unelevated:"",onClick:g},{default:a(()=>[c("\u041E\u043F\u043B\u0430\u0442\u0438\u0442\u044C")]),_:1})]))])),e(ge,{onHide:y.onHideBonusModal},null,8,["onHide"]),e(be)]))}};export{Te as default};
